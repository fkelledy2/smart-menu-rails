<div class="wizard-form mx-auto">
  <div class="text-center mb-5">
    <h1 class="h2 mb-3">Tell us about your restaurant</h1>
    <p class="text-muted">Help us customize your experience with some basic information.</p>
  </div>

  <%= form_with model: @onboarding, url: onboarding_path, method: :patch, local: true, 
                data: { step: 2 }, class: "needs-validation", novalidate: true do |f| %>
    
    <div class="mb-4">
      <%= f.label :restaurant_name, "Restaurant Name", class: "form-label" %>
      <%= f.text_field :restaurant_name, 
          class: "form-control form-control-lg", 
          placeholder: "Enter your restaurant name",
          required: true %>
      <div class="invalid-feedback">
        Please provide your restaurant name.
      </div>
    </div>

    <div class="row mb-4">
      <div class="col-md-6">
        <%= f.label :restaurant_type, "Restaurant Type", class: "form-label" %>
        <%= f.select :restaurant_type, 
            options_for_select([
              ['Fine Dining', 'fine_dining'],
              ['Casual Dining', 'casual_dining'],
              ['Fast Casual', 'fast_casual'],
              ['Quick Service', 'quick_service'],
              ['Cafe', 'cafe'],
              ['Bar & Grill', 'bar_grill'],
              ['Food Truck', 'food_truck'],
              ['Bakery', 'bakery'],
              ['Other', 'other']
            ], @onboarding&.restaurant_type),
            { prompt: 'Select type...' },
            { class: "form-select form-select-lg", required: true } %>
        <div class="invalid-feedback">
          Please select your restaurant type.
        </div>
      </div>
      
      <div class="col-md-6">
        <%= f.label :cuisine_type, "Cuisine Type", class: "form-label" %>
        <%= f.select :cuisine_type, 
            options_for_select([
              ['American', 'american'],
              ['Italian', 'italian'],
              ['Mexican', 'mexican'],
              ['Chinese', 'chinese'],
              ['Japanese', 'japanese'],
              ['Indian', 'indian'],
              ['French', 'french'],
              ['Mediterranean', 'mediterranean'],
              ['Thai', 'thai'],
              ['Greek', 'greek'],
              ['Spanish', 'spanish'],
              ['Korean', 'korean'],
              ['Vietnamese', 'vietnamese'],
              ['Middle Eastern', 'middle_eastern'],
              ['Fusion', 'fusion'],
              ['Other', 'other']
            ], @onboarding&.cuisine_type),
            { prompt: 'Select cuisine...' },
            { class: "form-select form-select-lg", required: true } %>
        <div class="invalid-feedback">
          Please select your cuisine type.
        </div>
      </div>
    </div>

    <div class="mb-4">
      <%= f.label :location, "Location", class: "form-label" %>
      <%= f.text_field :location, 
          class: "form-control form-control-lg", 
          placeholder: "City, State/Country",
          required: true %>
      <div class="form-text">This helps us set up currency and timezone defaults.</div>
      <div class="invalid-feedback">
        Please provide your restaurant location.
      </div>
    </div>

    <div class="mb-4">
      <%= f.label :phone, "Phone Number", class: "form-label" %>
      <%= f.telephone_field :phone, 
          class: "form-control form-control-lg", 
          placeholder: "+1 (555) 123-4567" %>
      <div class="form-text">Optional - for customer contact and reservations.</div>
    </div>

    <div class="d-flex justify-content-between align-items-center mt-5">
      <%= link_to onboarding_step_path(1), class: "btn btn-outline-secondary btn-lg btn-wizard" do %>
        <i class="fas fa-arrow-left me-2"></i>
        Back
      <% end %>
      
      <button type="submit" class="btn btn-primary btn-lg btn-wizard">
        Continue
        <i class="fas fa-arrow-right ms-2"></i>
      </button>
    </div>
  <% end %>
</div>

<!-- Tips section -->
<div class="mt-5">
  <div class="alert alert-info">
    <h6 class="alert-heading">
      <i class="fas fa-lightbulb me-2"></i>
      Pro Tips
    </h6>
    <ul class="mb-0 small">
      <li>Choose the restaurant type that best matches your service style</li>
      <li>Cuisine type helps us suggest relevant menu templates</li>
      <li>Location is used to set up local currency and timezone</li>
    </ul>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Form validation
  const form = document.querySelector('.needs-validation');
  
  form.addEventListener('submit', function(event) {
    if (!form.checkValidity()) {
      event.preventDefault();
      event.stopPropagation();
    }
    form.classList.add('was-validated');
  });
  
  // Load restaurant name from preview if available
  const restaurantNameInput = document.querySelector('#onboarding_session_restaurant_name');
  const previewName = sessionStorage.getItem('restaurant_name_preview');
  
  if (restaurantNameInput && previewName && !restaurantNameInput.value) {
    restaurantNameInput.value = previewName;
  }
  
  // Auto-format phone number
  const phoneInput = document.querySelector('#onboarding_session_phone');
  if (phoneInput) {
    phoneInput.addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length >= 6) {
        value = value.replace(/(\d{3})(\d{3})(\d{4})/, '($1) $2-$3');
      } else if (value.length >= 3) {
        value = value.replace(/(\d{3})(\d{3})/, '($1) $2');
      }
      e.target.value = value;
    });
  }
});
</script>
