<%= form_with(model: [tax.restaurant, tax]) do |form| %>
  <% if @futureParentRestaurant %>
    <%= form.hidden_field :restaurant_id, value: @futureParentRestaurant.id %>
  <% else %>
    <%= form.hidden_field :restaurant_id %>
  <% end %>

  <!-- Name -->
  <div class="form-group-2025 mb-4">
    <%= form.label :name, class: 'form-label-2025' do %>
      <%= t('.name', default: 'Tax Name') %>
      <span class="text-danger">*</span>
    <% end %>
    <%= form.text_field :name,
        class: 'form-control-2025',
        placeholder: t('.name_placeholder', default: 'e.g., Sales Tax, VAT, GST'),
        required: true %>
    <div class="form-help-2025">
      <%= t('.name_help', default: 'Display name for this tax') %>
    </div>
  </div>

  <!-- Tax Type -->
  <div class="form-group-2025 mb-4">
    <%= form.label :taxtype, class: 'form-label-2025' do %>
      <%= t('.tax_type', default: 'Tax Type') %>
      <span class="text-danger">*</span>
    <% end %>
    <%= form.select :taxtype,
        options_for_select(Tax.taxtypes.keys.to_a, form.object.taxtype),
        {},
        class: 'form-control-2025',
        required: true %>
    <div class="form-help-2025">
      <%= t('.tax_type_help', default: 'Select the type of tax') %>
    </div>
  </div>

  <!-- Tax Percentage -->
  <div class="form-group-2025 mb-4">
    <%= form.label :taxpercentage, class: 'form-label-2025' do %>
      <%= t('.tax_percentage', default: 'Tax Percentage') %>
      <span class="text-danger">*</span>
    <% end %>
    <div class="input-group flex-nowrap">
      <%= form.number_field :taxpercentage,
          class: 'form-control-2025',
          placeholder: t('.tax_percentage_placeholder', default: 'e.g., 8.5'),
          step: 0.01,
          min: 0,
          max: 100,
          required: true %>
      <span class="input-group-text">%</span>
    </div>
    <div class="form-help-2025">
      <%= t('.tax_percentage_help', default: 'Enter the tax rate as a percentage (0-100)') %>
    </div>
  </div>

  <!-- Error Messages -->
  <% if tax.errors.any? %>
    <div class="alert alert-danger" role="alert">
      <h6 class="alert-heading">
        <i class="bi bi-exclamation-triangle"></i>
        <%= t('common.errors', default: 'Errors') %>
      </h6>
      <ul class="mb-0">
        <% tax.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <!-- Form Actions -->
  <div class="d-flex justify-content-end gap-2 pt-3 border-top">
    <% if defined?(turbo_frame_request?) && turbo_frame_request? %>
      <%= link_to edit_restaurant_path(tax.restaurant, section: 'taxes_and_tips'),
          class: 'btn-2025 btn-2025-ghost btn-2025-md',
          data: { turbo_frame: 'restaurant_content' } do %>
        <%= t('common.cancel', default: 'Cancel') %>
      <% end %>
    <% else %>
      <%= link_to restaurant_taxes_path(tax.restaurant),
          class: 'btn-2025 btn-2025-ghost btn-2025-md' do %>
        <%= t('common.cancel', default: 'Cancel') %>
      <% end %>
    <% end %>

    <%= form.submit t('common.save', default: 'Save'),
        class: 'btn-2025 btn-2025-primary btn-2025-md' %>
  </div>
<% end %>
