<%# 
  Menu Settings Section
  Core configuration toggles for individual menu
%>

<% menu = local_assigns[:menu] || @menu %>
<% restaurant = menu.restaurant %>

<!-- General Settings -->
<div class="content-card-2025 py-4">
  <h2 class="content-card-title">
    <i class="bi bi-toggles"></i>
    <%= t('.general_settings', default: 'General Settings') %>
  </h2>
  
  <%= menu_form_with(menu, auto_save: true) do |form| %>
    <div class="form-group-2025 mb-4">
      <%= form.label :status, class: 'form-label-2025' do %>
        <%= t('activerecord.attributes.menu.status', default: 'Menu Status') %>
      <% end %>
      <%= form.select :status,
          options_for_select([
            [t('.status_active', default: 'Active - Menu is visible to customers'), 'active'],
            [t('.status_inactive', default: 'Inactive - Menu is hidden from customers'), 'inactive']
          ], menu.status),
          {},
          class: 'form-control-2025',
          **select_data_attributes(:default) %>
      <div class="form-help-2025">
        <%= t('.status_help', default: 'Controls whether this menu is visible to customers') %>
      </div>
    </div>
  <% end %>
</div>

<!-- Feature Toggles -->
<div class="content-card-2025">
  <h2 class="content-card-title">
    <i class="bi bi-sliders"></i>
    <%= t('.feature_toggles', default: 'Feature Toggles') %>
  </h2>
  
  <%= menu_form_with(menu, auto_save: true) do |form| %>
  <div class="features-grid">
    <!-- Display Images -->
    <div class="feature-card">
      <div class="feature-card-icon bg-primary">
        <i class="bi bi-image"></i>
      </div>
      <div class="feature-card-content">
        <h5 class="feature-card-title"><%= t('.display_images', default: 'Display Images') %></h5>
        <p class="feature-card-description">
          <%= t('.display_images_help', default: 'Show menu item images in this menu') %>
        </p>
      </div>
      <div class="feature-card-toggle">
        <div class="form-check form-switch">
          <input type="hidden" name="menu[displayImages]" value="false">
          <input class="form-check-input" 
                 type="checkbox" 
                 name="menu[displayImages]"
                 id="menu_displayImages_settings"
                 value="true"
                 <%= 'checked' if menu.displayImages %>
                 data-skip-tomselect="true">
        </div>
      </div>
    </div>
    
    <!-- Display Images in Popup -->
    <div class="feature-card">
      <div class="feature-card-icon bg-success">
        <i class="bi bi-window-stack"></i>
      </div>
      <div class="feature-card-content">
        <h5 class="feature-card-title"><%= t('.display_images_popup', default: 'Display Images in Popup') %></h5>
        <p class="feature-card-description">
          <%= t('.display_images_popup_help', default: 'Open menu item images in a popup modal when clicked') %>
        </p>
      </div>
      <div class="feature-card-toggle">
        <div class="form-check form-switch">
          <input type="hidden" name="menu[displayImagesInPopup]" value="false">
          <input class="form-check-input" 
                 type="checkbox" 
                 name="menu[displayImagesInPopup]"
                 id="menu_displayImagesInPopup_settings"
                 value="true"
                 <%= 'checked' if menu.displayImagesInPopup %>
                 data-skip-tomselect="true">
        </div>
      </div>
    </div>
    
    <!-- Allow Ordering -->
    <div class="feature-card">
      <div class="feature-card-icon bg-warning">
        <i class="bi bi-cart-check"></i>
      </div>
      <div class="feature-card-content">
        <h5 class="feature-card-title"><%= t('.allow_ordering', default: 'Allow Ordering') %></h5>
        <p class="feature-card-description">
          <%= t('.allow_ordering_help', default: 'Enable online ordering for this menu') %>
        </p>
      </div>
      <div class="feature-card-toggle">
        <div class="form-check form-switch">
          <input type="hidden" name="menu[allowOrdering]" value="false">
          <input class="form-check-input" 
                 type="checkbox" 
                 name="menu[allowOrdering]"
                 id="menu_allowOrdering_settings"
                 value="true"
                 <%= 'checked' if menu.allowOrdering %>
                 data-skip-tomselect="true">
        </div>
      </div>
    </div>
    
    <!-- Inventory Tracking -->
    <div class="feature-card">
      <div class="feature-card-icon bg-danger">
        <i class="bi bi-boxes"></i>
      </div>
      <div class="feature-card-content">
        <h5 class="feature-card-title"><%= t('.inventory_tracking', default: 'Inventory Tracking') %></h5>
        <p class="feature-card-description">
          <%= t('.inventory_tracking_help', default: 'Track stock levels for menu items (Coming Soon)') %>
        </p>
      </div>
      <div class="feature-card-toggle">
        <div class="form-check form-switch">
          <input class="form-check-input" 
                 type="checkbox" 
                 name="menu[inventoryTracking]"
                 id="menu_inventoryTracking_settings"
                 value="true"
                 <%= 'checked' if menu.inventoryTracking %>
                 data-skip-tomselect="true"
                 disabled>
        </div>
      </div>
    </div>
  </div>
  <% end %>
</div>

<!-- Settings Info -->
<div class="content-card-2025 bg-light">
  <div class="d-flex align-items-start gap-3">
    <div class="text-primary" style="font-size: 1.5rem;">
      <i class="bi bi-info-circle"></i>
    </div>
    <div>
      <h4 class="mb-2"><%= t('.settings_info_title', default: 'About Menu Settings') %></h4>
      <p class="text-sm text-muted mb-2">
        <%= t('.settings_info_desc', default: 'These settings control functionality for this specific menu. Changes are saved automatically.') %>
      </p>
      <ul class="text-sm text-muted mb-0 ps-3">
        <li><strong><%= t('.status', default: 'Status') %>:</strong> <%= t('.status_info', default: 'Controls menu visibility') %></li>
        <li><strong><%= t('.display_images', default: 'Display Images') %>:</strong> <%= t('.images_info', default: 'Toggle menu item photos') %></li>
        <li><strong><%= t('.display_images_popup', default: 'Images in Popup') %>:</strong> <%= t('.popup_info', default: 'Full-screen image viewing') %></li>
        <li><strong><%= t('.allow_ordering', default: 'Allow Ordering') %>:</strong> <%= t('.ordering_info', default: 'Enable customer orders') %></li>
      </ul>
    </div>
  </div>
</div>

<style>
  /* Feature Grid Layout */
  .features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-4);
  }
  
  .feature-card {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    padding: var(--space-4);
    background: white;
    border: 2px solid var(--color-gray-200);
    border-radius: var(--radius-lg);
    transition: all var(--transition-base);
  }
  
  .feature-card:hover {
    border-color: var(--color-gray-300);
    box-shadow: var(--shadow-sm);
  }
  
  .feature-card-icon {
    width: 48px;
    height: 48px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    flex-shrink: 0;
  }
  
  .feature-card-content {
    flex: 1;
  }
  
  .feature-card-title {
    font-size: var(--text-base);
    font-weight: var(--font-semibold);
    margin: 0 0 var(--space-2) 0;
    color: var(--color-gray-900);
  }
  
  .feature-card-description {
    font-size: var(--text-sm);
    color: var(--color-gray-600);
    margin: 0;
    line-height: 1.5;
  }
  
  .feature-card-toggle {
    padding-top: var(--space-2);
    border-top: 1px solid var(--color-gray-100);
  }
  
  .feature-card-toggle .form-switch {
    display: flex;
    justify-content: flex-end;
  }
  
  /* Mobile responsive */
  @media (max-width: 768px) {
    .features-grid {
      grid-template-columns: 1fr;
    }
  }
  
  .bg-light {
    background: var(--color-gray-50) !important;
  }
</style>
