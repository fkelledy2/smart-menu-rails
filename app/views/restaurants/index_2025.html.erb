<%# 2025 Restaurants Index - Cards + Tabs with Turbo Frame %>
<% content_for :title, t('.title', default: 'Your Restaurants') %>

<div class="container-fluid px-0 py-4">
  <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 mb-3">
    <div>
      <h1 class="text-2xl fw-semibold mb-1"><%= t('.heading', default: 'Restaurants') %></h1>
      <p class="text-muted mb-0"><%= t('.subtitle', default: 'Manage locations, menus and staff') %></p>
    </div>

    <div class="d-flex align-items-center gap-2">
      <%= form_with url: restaurants_path, method: :get, data: { turbo_frame: 'restaurants_content', turbo_action: 'advance' }, class: 'd-flex' do |f| %>
        <div class="input-group">
          <%= f.text_field :q,
              value: @q,
              class: 'form-control',
              placeholder: t('.search_placeholder', default: 'Search restaurants…'),
              aria: { label: t('.search_placeholder', default: 'Search restaurants…') } %>
          <button class="btn btn-outline-secondary" type="submit" aria-label="<%= t('.search', default: 'Search') %>">
            <i class="bi bi-search"></i>
          </button>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Quick Actions Card -->
  <div class="quick-actions-card mb-4" data-testid="restaurants-quick-actions">
    <h2 class="quick-actions-title">
      <i class="bi bi-lightning-charge"></i>
      <%= t('.quick_actions', default: 'Quick Actions') %>
    </h2>

    <div class="quick-actions-grid">
      <%= link_to new_restaurant_path,
          class: 'quick-action-btn',
          data: { turbo_frame: 'new_restaurant_modal', bs_toggle: 'modal', bs_target: '#newRestaurantModal', testid: 'new-restaurant-btn' } do %>
        <i class="bi bi-plus-circle"></i>
        <span><%= t('.new_restaurant', default: 'New Restaurant') %></span>
      <% end %>
    </div>
  </div>

  <%= turbo_frame_tag 'restaurants_content' do %>
    <%= render 'restaurants/index_frame_2025', restaurants: @restaurants, filter: @filter, q: @q, counts: @counts %>
  <% end %>

  <div class="modal fade" id="newRestaurantModal" tabindex="-1" aria-labelledby="newRestaurantModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl new-restaurant-modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="newRestaurantModalLabel"><%= t('.new_restaurant', default: 'New Restaurant') %></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="<%= t('common.close', default: 'Close') %>"></button>
        </div>
        <div class="modal-body">
          <%= turbo_frame_tag 'new_restaurant_modal', src: new_restaurant_path do %>
            <div class="text-muted"><%= t('common.loading', default: 'Loading…') %></div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
