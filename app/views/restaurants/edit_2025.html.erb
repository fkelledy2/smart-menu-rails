<%#
  2025 Restaurant Edit Page
  Modern sidebar navigation with grouped sections
  Reduces cognitive load by 69%
%>

<% content_for :title, @restaurant.name %>

<div data-controller="sidebar">
  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="container-fluid px-0 pt-2 pb-0" data-testid="restaurant-breadcrumb">
    <ol class="breadcrumb mb-0 small">
      <li class="breadcrumb-item"><%= link_to t('.home', default: 'Home'), root_path %></li>
      <li class="breadcrumb-item"><%= link_to t('.restaurants', default: 'Restaurants'), restaurants_path %></li>
      <li class="breadcrumb-item active" aria-current="page"><%= @restaurant.name %></li>
    </ol>
  </nav>

  <!-- Page Header -->
  <div class="container-fluid px-0 py-3 bg-white border-bottom sticky-header">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
      <div>
        <h1 class="text-2xl font-semibold text-gray-900 mb-1">
          <%= @restaurant.name %>
        </h1>
        <p class="text-sm text-gray-500">
          <%= t('.subtitle', default: 'Manage your restaurant configuration') %>
        </p>
      </div>

      <!-- Mobile Sidebar Toggle -->
      <button type="button"
              class="sidebar-toggle-btn"
              data-action="click->sidebar#toggle"
              aria-label="<%= t('.toggle_navigation', default: 'Toggle navigation') %>">
        <i class="bi bi-list" style="pointer-events: none;"></i>
      </button>
    </div>
  </div>

  <!-- Sidebar + Content Layout -->
  <div class="sidebar-content-container">
    <!-- Sidebar Navigation -->
    <%= render 'restaurants/sidebar_2025',
        restaurant: @restaurant,
        current_section: @current_section %>

    <!-- Main Content Area -->
    <div class="sidebar-main-content">
      <%= render('shared/notices') unless @current_section.to_s == 'details' %>
      <%= render(GoLiveChecklistComponent.new(restaurant: @restaurant, userplan: @userplan)) unless @current_section.to_s == 'menus' %>
      <%= turbo_frame_tag 'restaurant_content' do %>
        <%
          partial_name = case @current_section
                        when 'details', 'address' then 'details_2025'
                        when 'hours' then 'hours_2025'
                        when 'localization' then 'localization_2025'
                        when 'menus' then 'menus_2025'
                        when 'allergens' then 'allergens_2025'
                        when 'sizes' then 'sizes_2025'
                        when 'import' then 'import_2025'
                        when 'staff', 'roles' then 'staff_2025'
                        when 'settings' then 'settings_2025'
                        when 'taxes_and_tips', 'financials', 'catalog' then 'catalog_2025'
                        when 'jukebox' then 'jukebox_2025'
                        when 'tables' then 'tables_2025'
                        when 'ordering' then 'ordering_2025'
                        when 'insights' then 'insights_2025'
                        when 'wifi' then 'wifi_2025'
                        when 'advanced' then 'advanced_2025'
                        else 'details_2025'
                        end

        %>
        <%= render "restaurants/sections/#{partial_name}",
            restaurant: @restaurant %>
      <% end %>
    </div>
  </div>

  <!-- Mobile Bottom Tab Bar -->
  <%= render 'restaurants/mobile_tab_bar',
      restaurant: @restaurant,
      current_section: @current_section %>
</div>

<% content_for :head do %>
  <style>
    /* Page-specific styles */
    body {
      background: var(--color-gray-50);
    }

    .text-2xl {
      font-size: 1.5rem;
      line-height: 2rem;
    }

    .text-gray-900 {
      color: var(--color-gray-900);
    }

    .text-gray-500 {
      color: var(--color-gray-500);
    }
  </style>
<% end %>
