<%= stylesheet_link_tag 'kitchen_dashboard_bootstrap', media: 'all' %>

<div class="kitchen-dashboard min-vh-100" data-restaurant-id="<%= @restaurant.id %>" data-station="bar">
  <div class="container-fluid mb-4">
    <div class="row g-3">
      <div class="col-md-3">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <div class="display-4 fw-bold text-danger" id="pending-count"><%= @metrics[:total_pending] %></div>
            <div class="text-muted text-uppercase small fw-bold">Pending Tickets</div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <div class="display-4 fw-bold text-warning" id="preparing-count"><%= @metrics[:total_preparing] %></div>
            <div class="text-muted text-uppercase small fw-bold">Preparing</div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <div class="display-4 fw-bold text-success" id="ready-count"><%= @metrics[:total_ready] %></div>
            <div class="text-muted text-uppercase small fw-bold">Ready</div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card border-0 shadow-sm">
          <div class="card-body text-center">
            <div class="display-4 fw-bold text-info">&nbsp;</div>
            <div class="text-muted text-uppercase small fw-bold">&nbsp;</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container-fluid">
    <div class="row g-3">
      <div class="col-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-danger text-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              Pending
              <span class="badge bg-white text-danger ms-2"><%= @pending_tickets.count %></span>
            </h5>
            <button type="button" class="btn btn-light btn-sm sort-toggle-btn" data-column="pending" data-direction="asc" title="Sort: Oldest First">
              <i class="bi bi-sort-up"></i>
            </button>
          </div>
          <div class="card-body p-2 overflow-auto" style="max-height: calc(100vh - 350px);" id="pending-orders">
            <div class="text-center text-muted py-4 empty-state" data-empty-for="pending" style="<%= @pending_tickets.any? ? 'display:none;' : '' %>">0 pending tickets</div>
            <%= render partial: 'station_ticket_card', collection: @pending_tickets, as: :ticket %>
          </div>
        </div>
      </div>

      <div class="col-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              Preparing
              <span class="badge bg-white text-warning ms-2"><%= @preparing_tickets.count %></span>
            </h5>
            <button type="button" class="btn btn-light btn-sm sort-toggle-btn" data-column="preparing" data-direction="asc" title="Sort: Oldest First">
              <i class="bi bi-sort-up"></i>
            </button>
          </div>
          <div class="card-body p-2 overflow-auto" style="max-height: calc(100vh - 350px);" id="preparing-orders">
            <div class="text-center text-muted py-4 empty-state" data-empty-for="preparing" style="<%= @preparing_tickets.any? ? 'display:none;' : '' %>">0 preparing tickets</div>
            <%= render partial: 'station_ticket_card', collection: @preparing_tickets, as: :ticket %>
          </div>
        </div>
      </div>

      <div class="col-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              Ready
              <span class="badge bg-white text-success ms-2"><%= @ready_tickets.count %></span>
            </h5>
            <button type="button" class="btn btn-light btn-sm sort-toggle-btn" data-column="ready" data-direction="asc" title="Sort: Oldest First">
              <i class="bi bi-sort-up"></i>
            </button>
          </div>
          <div class="card-body p-2 overflow-auto" style="max-height: calc(100vh - 350px);" id="ready-orders">
            <div class="text-center text-muted py-4 empty-state" data-empty-for="ready" style="<%= @ready_tickets.any? ? 'display:none;' : '' %>">0 ready tickets</div>
            <%= render partial: 'station_ticket_card', collection: @ready_tickets, as: :ticket %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%= javascript_include_tag 'station_dashboard', defer: true %>
