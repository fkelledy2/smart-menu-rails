<% if current_user %>
  <!-- Quick Actions Card -->
  <div class="quick-actions-card mb-4">
    <h2 class="quick-actions-title">
      <i class="bi bi-lightning-charge"></i>
      <%= t('.quick_actions', default: 'Quick Actions') %>
    </h2>

    <div class="quick-actions-grid">
      <%= link_to new_restaurant_tablesetting_path(@restaurant),
          class: 'quick-action-btn',
          data: { turbo_frame: '_top' } do %>
        <i class="bi bi-plus-circle"></i>
        <span><%= t('.add_table', default: 'Add Table') %></span>
      <% end %>

      <% if @futureParentRestaurant %>
        <%= link_to restaurant_path(id: @futureParentRestaurant.id), class: 'quick-action-btn' do %>
          <i class="bi bi-chevron-left"></i>
          <span><%= t('.back', default: 'Back') %></span>
        <% end %>
      <% end %>

      <button id="unarchive-row" class="quick-action-btn btn-2025" disabled>
        <i class="bi bi-arrow-counterclockwise"></i>
        <span><%= t('.unarchive') %></span>
      </button>

      <button id="archive-row" class="quick-action-btn btn-2025" disabled>
        <i class="bi bi-archive"></i>
        <span><%= t('.archive') %></span>
      </button>
    </div>
  </div>

  <!-- Overview Card -->
  <div class="content-card-2025 py-4 mb-4">
    <h2 class="content-card-title">
      <i class="bi bi-layout-wtf"></i>
      <%= t('.tables_overview', default: 'Tables') %>
    </h2>

    <p class="text-muted mb-4">
      <%= t('.tables_description', default: 'Manage your restaurant tables to enable QR codes and ordering by table.') %>
    </p>

    <div class="allergen-stats-card">
      <div class="allergen-stat">
        <div class="allergen-stat-value"><%= @restaurant.tablesettings.count %></div>
        <div class="allergen-stat-label"><%= t('.total_tables', default: 'Total Tables') %></div>
      </div>
    </div>
  </div>

  <!-- Table Container (Tabulator target) -->
  <div class="content-card-2025">
    <h2 class="content-card-title mb-3">
      <i class="bi bi-list-check"></i>
      <%= t('.table_settings') %>
    </h2>
    <div class="table-container-spacing table-borderless" id="tablesetting-table"></div>
  </div>

  <style>
    .quick-actions-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: var(--space-3);
    }
    .quick-actions-grid .quick-action-btn { width: 100%; justify-content: center; }
    .allergen-stats-card {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-4);
      padding: var(--space-4);
      background: var(--color-gray-50);
      border: 1px solid var(--color-gray-200);
      border-radius: var(--radius-lg);
    }
    .allergen-stat { text-align: center; }
    .allergen-stat-value { font-size: 2.5rem; font-weight: var(--font-bold); color: var(--color-primary); margin-bottom: var(--space-2); }
    .allergen-stat-label { font-size: var(--text-sm); color: var(--color-gray-600); font-weight: var(--font-semibold); }
  </style>
<% else %>
    <%= format('%02d',@currentDay) %> - <%= format('%02d',@currentHour) %>:<%= format('%02d',@currentMin) %>
    <div class="row section-spacing-bottom">
        <div class="col-12">
            <span class="h1 text-center"><%= @restaurant.name %>: <%= t('.seating_plan') %></span>
        </div>
    </div>
    <div class="row">
        <% @tablesettings.each do |tablesetting| %>
            <div class="col-4">
                <% if tablesetting.status == 'occupied' %>
                <div class="card text-white bg-danger mb-3">
                <% else %>
                <div class="card text-white bg-success mb-3">
                <% end %>
                  <div class="card-body">
                    <h2 class="card-title">
                        <% if tablesetting.status == 'occupied' %>
                            <div class="btn-2025 btn-2025-outline-danger btn-2025-lg">
                                <h2><%= tablesetting.name %></h2>
                            </div>
                        <% else %>
                            <%= link_to restaurant_tablesetting_path(@restaurant, tablesetting), class: 'btn-2025 btn-2025-primary btn-2025-lg' do %>
                                <h2><%= tablesetting.name %></h2>
                            <% end %>
                        <% end %>
                        <span class="padding-top-7px float-end"><%= t('.seats') %> <%= tablesetting.capacity %></span>
                    </h2>
                    <div class="row">
                        <div class="col-12">
                            <p class="p-5 h3 text-center"><%= tablesetting.tabletype.capitalize %></p>
                        </div>
                    </div>
                  </div>
                </div>
            </div>
        <% end %>
    </div>
<% end %>
